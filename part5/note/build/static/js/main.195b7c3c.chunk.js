(this["webpackJsonppart2-notes"]=this["webpackJsonppart2-notes"]||[]).push([[0],{44:function(t,e,n){"use strict";n.r(e);var r=n(19),a=n.n(r),c=n(10),o=n(5),u=n(3),s=n(4),i=n.n(s),l=n(1),j=n(0),d=function(t){var e=t.note,n=t.toggleImportant,r=e.important?"make not important":"make important";return Object(j.jsxs)("li",{children:[e.content,Object(j.jsx)("button",{onClick:n,children:r})]})},b=n(6),p=n.n(b),f="/api/notes",h=null,O=function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={headers:{Authorization:h}},t.next=3,p.a.post(f,e,n);case 3:return r=t.sent,t.abrupt("return",r.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g={getAll:function(){return p.a.get(f).then((function(t){return t.data}))},create:O,update:function(t,e){return p.a.put("".concat(f,"/").concat(t),e).then((function(t){return t.data})).catch((function(t){console.log(t)}))},setToken:function(t){h="bearer ".concat(t)}},v=function(){var t=Object(o.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.post("/api/login",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x={login:v,logout:function(){window.localStorage.removeItem("loggedNoteappUser")}},m=function(t){var e=Object(l.useState)(!1),n=Object(u.a)(e,2),r=n[0],a=n[1],c={display:r?"none":""},o={display:r?"":"none"},s=function(){a(!r)};return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{style:c,children:Object(j.jsx)("button",{onClick:s,children:t.buttonLabel})}),Object(j.jsxs)("div",{style:o,children:[t.children,Object(j.jsx)("button",{onClick:s,children:"cancel"})]})]})},w=function(t){var e=t.addNote,n=Object(l.useState)(""),r=Object(u.a)(n,2),a=r[0],c=r[1];return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h2",{children:"Create a new note"}),Object(j.jsxs)("form",{onSubmit:e,children:[Object(j.jsx)("input",{value:a,onChange:function(t){c(t.target.value)},placeholder:"New note"}),Object(j.jsx)("button",{type:"submit",children:"Save"})]})]})},k=function(t){var e=t.handleLogin,n=t.handleUsernameChange,r=t.handlePasswordChange,a=t.username,c=t.password;t.loginVisible;return Object(j.jsxs)("form",{onSubmit:e,children:[Object(j.jsxs)("div",{children:["Username",Object(j.jsx)("input",{type:"text",value:a,name:"Username",onChange:function(t){var e=t.target;return n(e.value)}})]}),Object(j.jsxs)("div",{children:["Password",Object(j.jsx)("input",{type:"text",value:c,name:"Password",onChange:function(t){var e=t.target;return r(e.value)}})]}),Object(j.jsx)("button",{type:"submit",children:"login"})]})},y=function(t){var e=Object(l.useState)([]),n=Object(u.a)(e,2),r=n[0],a=n[1],s=Object(l.useState)(!0),b=Object(u.a)(s,2),p=b[0],f=b[1],h=Object(l.useState)(""),O=Object(u.a)(h,2),v=O[0],y=O[1],S=Object(l.useState)(""),C=Object(u.a)(S,2),N=C[0],U=C[1],I=Object(l.useState)(null),L=Object(u.a)(I,2),J=(L[0],L[1]),P=Object(l.useState)(null),T=Object(u.a)(P,2),A=T[0],E=T[1],F=Object(l.useState)(!1),z=Object(u.a)(F,2),B=z[0],D=z[1];Object(l.useEffect)((function(){g.getAll().then((function(t){a(t)})).catch((function(t){return console.log(t)}))}),[]),Object(l.useEffect)((function(){var t=window.localStorage.getItem("loggedNoteappUser");if(t){var e=JSON.parse(t);E(e),g.setToken(e.token)}}),[]);var V=function(){var t=Object(o.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),console.log("logging in with ",v,N),t.prev=2,t.next=5,x.login({username:v,password:N});case 5:n=t.sent,window.localStorage.setItem("loggedNoteappUser",JSON.stringify(n)),g.setToken(n.token),E(n),y(""),U(""),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),J("Wrong credentials"),setTimeout((function(){J(null)}),5e3);case 17:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e){return t.apply(this,arguments)}}(),W=p?r:r.filter((function(t){return t.important})),q=function(){var t=Object(o.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.create(e);case 2:n=t.sent,a(r.concat(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Notes"}),null===A?function(){var t={display:B?"none":""},e={display:B?"":"none"};return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{style:t,children:Object(j.jsx)("button",{onClick:function(){return D(!0)},children:"Login"})}),Object(j.jsxs)("div",{style:e,children:[Object(j.jsx)(k,{username:v,password:N,handleUsernameChange:function(t){var e=t.target;return y(e.value)},handlePasswordChange:function(t){var e=t.target;return U(e.value)},handleLogin:V,setNotes:a}),Object(j.jsx)("button",{onClick:function(){D(!1)},children:"Cancel"})]})]})}():Object(j.jsx)(m,{buttonLabel:"new note",children:Object(j.jsx)(w,{addNote:q})}),Object(j.jsx)("div",{children:Object(j.jsxs)("button",{id:"show-button",onClick:function(){return f(!p)},children:["Show ",p?"important":"all"]})}),Object(j.jsxs)("ul",{children:[console.log("notes to show: ",W),W.map((function(t,e){return Object(j.jsx)(d,{note:t,toggleImportance:function(){return function(t){var e=r.find((function(e){return e.id===t})),n=Object(c.a)(Object(c.a)({},e),{},{important:!e.important});g.update(t,n).then((function(e){a(r.map((function(n){return n.id!==t?n:e})))})).catch((function(n){alert("the note '".concat(e.content,"' was already deleted from server")),a(r.filter((function(e){return e.id!==t})))}))}(t.id)}},e)}))]})]})};a.a.render(Object(j.jsx)(y,{}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.195b7c3c.chunk.js.map